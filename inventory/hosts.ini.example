# RKE2/K3S Ansible Inventory 示例配置
# 
# 使用说明：
# 1. 复制此文件为 hosts.ini: cp hosts.ini.example hosts.ini
# 2. 根据集群类型选择相应的配置场景（RKE2 或 K3S）
# 3. 修改 IP 地址、主机名和连接配置
# 4. 取消注释所需的配置场景
# 5. 配置 group_vars 目录下的变量文件

# ============================================================================
# 🔹 K3S 配置示例
# ============================================================================
# K3S 特点：
#   - 轻量级 Kubernetes (< 512MB 内存)
#   - 适合边缘计算、IoT、开发测试环境
#   - API Server 端口: 6443
#   - 单二进制文件，快速部署

# 场景 K3S-1: 单节点测试集群
# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
#[rke_servers]
#node1 ansible_host=192.168.1.10 cluster_init=true
#
#[all:vars]
#ansible_user=root
#ansible_ssh_private_key_file=~/.ssh/id_rsa
#cluster_type=k3s
#server_url=https://192.168.1.10:6443

# 场景 K3S-2: 高可用集群 (3 Server)
# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
#[rke_servers]
#node1 ansible_host=192.168.1.10 cluster_init=true
#node2 ansible_host=192.168.1.11
#node3 ansible_host=192.168.1.12
#
#[all:vars]
#ansible_user=root
#ansible_ssh_private_key_file=~/.ssh/id_rsa
#cluster_type=k3s
#server_url=https://192.168.1.10:6443

# 场景 K3S-3: Server + Agent 混合集群
# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
#[rke_servers]
#master1 ansible_host=192.168.1.10 cluster_init=true
#master2 ansible_host=192.168.1.11
#master3 ansible_host=192.168.1.12
#
#[rke_agents]
#worker1 ansible_host=192.168.1.20
#worker2 ansible_host=192.168.1.21
#worker3 ansible_host=192.168.1.22
#
#[all:vars]
#ansible_user=root
#ansible_ssh_private_key_file=~/.ssh/id_rsa
#cluster_type=k3s
#server_url=https://192.168.1.10:6443

# ============================================================================
# 🔹 RKE2 配置示例
# ============================================================================
# RKE2 特点：
#   - 企业级 Kubernetes (SUSE 官方支持)
#   - 适合生产环境、合规要求高的场景
#   - API Server 端口: 9345 (默认), 6443 (Kubernetes API)
#   - FIPS 140-2 认证、SELinux 强化、CIS 基准测试

# 场景 RKE2-1: 单节点测试集群
# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
#[rke_servers]
#node1 ansible_host=192.168.1.10 cluster_init=true
#
#[all:vars]
#ansible_user=root
#ansible_ssh_private_key_file=~/.ssh/id_rsa
#cluster_type=rke2
#server_url=https://192.168.1.10:9345

# 场景 RKE2-2: 高可用集群 (3 Server) - 默认配置
# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
[rke_servers]
node1 ansible_host=192.168.1.10 cluster_init=true
node2 ansible_host=192.168.1.11
node3 ansible_host=192.168.1.12

[rke_agents]
# 如需添加 Agent 节点，取消下面的注释并修改 IP
#worker1 ansible_host=192.168.1.20

# 场景 RKE2-3: Server + Agent 混合集群
# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
#[rke_servers]
#master1 ansible_host=192.168.1.10 cluster_init=true
#master2 ansible_host=192.168.1.11
#master3 ansible_host=192.168.1.12
#
#[rke_agents]
#worker1 ansible_host=192.168.1.20
#worker2 ansible_host=192.168.1.21
#worker3 ansible_host=192.168.1.22

# ============================================================================
# 全局变量 (所有节点) - 必须配置
# ============================================================================
[rke_servers:vars]
node_role=server

[rke_agents:vars]
node_role=agent

[all:vars]
# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
# 🔧 Ansible 连接配置 (必须修改)
# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
ansible_user=root
ansible_ssh_private_key_file=~/.ssh/id_rsa
ansible_ssh_common_args='-o StrictHostKeyChecking=no'

# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
# 🎯 集群类型配置 (重要！)
# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
# 选项：rke2 或 k3s
cluster_type=rke2

# RKE2 vs K3S 选择建议：
# ┌─────────────┬──────────────────────────────────────┐
# │ 使用 RKE2  │ 生产环境、合规要求、企业级应用        │
# ├─────────────┼──────────────────────────────────────┤
# │ 使用 K3S   │ 边缘计算、IoT、开发测试、低资源环境   │
# └─────────────┴──────────────────────────────────────┘

# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
# 🌏 中国大陆镜像加速 (推荐启用)
# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
china_region=false
# 启用后将使用 rancher-mirror.rancher.cn 和其他国内镜像

# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
# 📦 安装版本 (可选，留空安装最新稳定版)
# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
install_version=
# RKE2 示例: v1.33.5+rke2r1
# K3S  示例: v1.33.5+k3s1

# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
# 🔐 集群 Token (推荐留空，自动获取)
# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
cluster_token=
# 留空: 自动从初始节点获取 (推荐)
# 手动: 使用 ansible-vault encrypt_string 加密后配置

# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
# 🌐 API Server 地址 (自动获取或手动配置)
# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
# 留空: 系统自动从初始 Server 节点获取 (推荐)
#   RKE2: 自动使用 https://初始节点IP:9345
#   K3S:  自动使用 https://初始节点IP:6443
# 手动配置: 使用负载均衡器时需要手动配置
#   示例: server_url=https://lb.example.com:9345
server_url=

# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
# 🔒 TLS 配置
# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
# TLS SAN (Subject Alternative Names)
tls_san=['192.168.1.10', '192.168.1.11', '192.168.1.12', 'k8s.example.com']

# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
# ⚙️  系统优化 (推荐)
# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
disable_swap=true
load_kernel_modules=true
configure_sysctl=true

# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
# 💾 备份配置 (可选)
# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
enable_backup=false
etcd_snapshot_retention=5

# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
# 🔥 防火墙配置 (可选)
# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
configure_firewall=false

# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
# 📝 配置完成后：
#   1. 保存文件
#   2. 运行: make install (部署集群)
#   3. 或：  make install-china (中国大陆部署)
# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
