# ä»“åº“é‡ç½®å’Œæ¸…ç†æŒ‡å—

## ğŸ“‹ æ¦‚è¿°

æœ¬é¡¹ç›®æä¾›ä¸¤ä¸ªæ¸…ç†å‘½ä»¤ï¼Œç”¨äºä¸åŒçš„æ¸…ç†åœºæ™¯ï¼š

| å‘½ä»¤ | ç”¨é€” | åˆ é™¤å†…å®¹ | å®‰å…¨æ€§ |
|------|------|---------|--------|
| `make clean` | æ¸…ç†ä¸´æ—¶æ–‡ä»¶ | æ—¥å¿—ã€ç¼“å­˜ã€ä¸´æ—¶æ–‡ä»¶ | âœ… å®‰å…¨ |
| `make reset` | é‡ç½®åˆ°åˆå§‹çŠ¶æ€ | æ‰€æœ‰æœ¬åœ°é…ç½® + ä¸´æ—¶æ–‡ä»¶ | âš ï¸ éœ€ç¡®è®¤ |

---

## ğŸ§¹ make clean - æ¸…ç†ä¸´æ—¶æ–‡ä»¶

### ç”¨é€”
æ¸…ç†å®‰è£…å’Œä½¿ç”¨è¿‡ç¨‹ä¸­äº§ç”Ÿçš„ä¸´æ—¶æ–‡ä»¶ï¼Œä½†**ä¿ç•™**æ‰€æœ‰é…ç½®æ–‡ä»¶ã€‚

### åˆ é™¤çš„æ–‡ä»¶
```
âœ“ *.retry           - Ansible é‡è¯•æ–‡ä»¶
âœ“ __pycache__/      - Python ç¼“å­˜
âœ“ *.log             - æ—¥å¿—æ–‡ä»¶
âœ“ /tmp/*-token.txt  - ä¸´æ—¶ Token æ–‡ä»¶
```

### ä¿ç•™çš„æ–‡ä»¶
```
âœ“ inventory/hosts.ini              - æ‚¨çš„èŠ‚ç‚¹é…ç½®
âœ“ inventory/group_vars/all.yml     - æ‚¨çš„é›†ç¾¤é…ç½®
âœ“ æ‰€æœ‰å…¶ä»–é…ç½®å’Œæ•°æ®
```

### ä½¿ç”¨æ–¹æ³•
```bash
make clean
```

### è¾“å‡ºç¤ºä¾‹
```
æ¸…ç†ä¸´æ—¶æ–‡ä»¶...
âœ“ æ¸…ç†å®Œæˆ
```

### ä½¿ç”¨åœºæ™¯
- âœ… æäº¤ä»£ç å‰æ¸…ç†
- âœ… æ—¥å¸¸ç»´æŠ¤æ¸…ç†
- âœ… é‡Šæ”¾ç£ç›˜ç©ºé—´
- âœ… æ’æŸ¥é—®é¢˜å‰æ¸…ç†

---

## ğŸ”„ make reset - é‡ç½®åˆ°åˆå§‹çŠ¶æ€

### ç”¨é€”
å®Œå…¨é‡ç½®ä»“åº“åˆ°åˆå§‹çŠ¶æ€ï¼Œåˆ é™¤**æ‰€æœ‰æœ¬åœ°é…ç½®**ï¼Œæ¢å¤åˆ°åˆšå…‹éš†æ—¶çš„çŠ¶æ€ã€‚

### åˆ é™¤çš„æ–‡ä»¶
```
âš ï¸ inventory/hosts.ini              - æ‚¨çš„èŠ‚ç‚¹é…ç½®ï¼ˆIPã€SSH ä¿¡æ¯ï¼‰
âš ï¸ inventory/group_vars/all.yml     - æ‚¨çš„é›†ç¾¤é…ç½®ï¼ˆTokenã€å¯†ç ï¼‰
âœ“ *.retry                           - Ansible é‡è¯•æ–‡ä»¶
âœ“ __pycache__/                      - Python ç¼“å­˜
âœ“ *.log                             - æ—¥å¿—æ–‡ä»¶
âœ“ /tmp/*-token.txt                  - ä¸´æ—¶ Token æ–‡ä»¶
```

### ä¿ç•™çš„æ–‡ä»¶
```
âœ“ inventory/hosts.ini.example       - ç¤ºä¾‹é…ç½®ï¼ˆä¸å—å½±å“ï¼‰
âœ“ inventory/group_vars/all.yml.example - ç¤ºä¾‹é…ç½®ï¼ˆä¸å—å½±å“ï¼‰
âœ“ æ‰€æœ‰æºä»£ç å’Œæ–‡æ¡£
```

### ä½¿ç”¨æ–¹æ³•
```bash
make reset
```

### äº¤äº’å¼ç¡®è®¤
```
========================================
  è­¦å‘Š: æ­¤æ“ä½œå°†åˆ é™¤æ‰€æœ‰æœ¬åœ°é…ç½®ï¼
========================================

å°†åˆ é™¤ä»¥ä¸‹æ–‡ä»¶:
  â€¢ inventory/hosts.ini
  â€¢ inventory/group_vars/all.yml
  â€¢ æ‰€æœ‰ä¸´æ—¶æ–‡ä»¶å’Œæ—¥å¿—

ç¡®è®¤é‡ç½®? è¾“å…¥ 'yes' ç»§ç»­: yes
```

### è¾“å‡ºç¤ºä¾‹
```
å¼€å§‹æ¸…ç†...
âœ“ åˆ é™¤ inventory/hosts.ini
âœ“ åˆ é™¤ inventory/group_vars/all.yml

========================================
  âœ“ ä»“åº“å·²é‡ç½®åˆ°åˆå§‹çŠ¶æ€
========================================

ä¸‹ä¸€æ­¥:
  1. è¿è¡Œ make setup é‡æ–°åˆå§‹åŒ–é…ç½®
  2. æˆ–ä½¿ç”¨ git status æ£€æŸ¥çŠ¶æ€
```

### ä½¿ç”¨åœºæ™¯
- âœ… æäº¤åˆ° Git ä»“åº“å‰æ¸…ç†
- âœ… é‡æ–°å¼€å§‹é…ç½®
- âœ… åˆ‡æ¢åˆ°ä¸åŒç¯å¢ƒ
- âœ… æ¼”ç¤ºæˆ–æµ‹è¯•å‰é‡ç½®
- âš ï¸ **ä¸é€‚åˆ**ï¼šæ—¥å¸¸ç»´æŠ¤ï¼ˆä½¿ç”¨ `make clean` ä»£æ›¿ï¼‰

---

## ğŸ”„ å®Œæ•´çš„é‡ç½®å·¥ä½œæµ

### åœºæ™¯ 1: æäº¤ä»£ç åˆ° Git

```bash
# 1. é‡ç½®ä»“åº“ï¼ˆåˆ é™¤æ•æ„Ÿé…ç½®ï¼‰
make reset
# è¾“å…¥ 'yes' ç¡®è®¤

# 2. æ£€æŸ¥ Git çŠ¶æ€
git status
# åº”è¯¥æ˜¾ç¤º clean

# 3. æ·»åŠ å’Œæäº¤
git add .
git commit -m "Your commit message"
git push origin main
```

### åœºæ™¯ 2: åˆ‡æ¢ç¯å¢ƒé…ç½®

```bash
# 1. å¤‡ä»½å½“å‰é…ç½®ï¼ˆå¯é€‰ï¼‰
cp inventory/hosts.ini inventory/hosts.ini.prod.backup
cp inventory/group_vars/all.yml inventory/group_vars/all.yml.prod.backup

# 2. é‡ç½®
make reset
# è¾“å…¥ 'yes' ç¡®è®¤

# 3. é‡æ–°é…ç½®æ–°ç¯å¢ƒ
make setup
vim inventory/hosts.ini
vim inventory/group_vars/all.yml

# 4. éƒ¨ç½²åˆ°æ–°ç¯å¢ƒ
make install
```

### åœºæ™¯ 3: ä»å¤´å¼€å§‹

```bash
# 1. é‡ç½®æ‰€æœ‰
make reset
# è¾“å…¥ 'yes' ç¡®è®¤

# 2. é‡æ–°åˆå§‹åŒ–
make setup

# 3. æŒ‰ç…§æç¤ºé…ç½®
vim inventory/hosts.ini
vim inventory/group_vars/all.yml

# 4. å¼€å§‹éƒ¨ç½²
make install
```

---

## ğŸ’¾ é…ç½®å¤‡ä»½å»ºè®®

åœ¨æ‰§è¡Œ `make reset` å‰ï¼Œå»ºè®®å¤‡ä»½é‡è¦é…ç½®ï¼š

### æ‰‹åŠ¨å¤‡ä»½
```bash
# åˆ›å»ºå¤‡ä»½ç›®å½•
mkdir -p ~/k8s-config-backups/$(date +%Y%m%d)

# å¤‡ä»½é…ç½®æ–‡ä»¶
cp inventory/hosts.ini ~/k8s-config-backups/$(date +%Y%m%d)/
cp inventory/group_vars/all.yml ~/k8s-config-backups/$(date +%Y%m%d)/

# æ·»åŠ å¤‡ä»½è¯´æ˜
echo "ç¯å¢ƒ: ç”Ÿäº§ç¯å¢ƒ" > ~/k8s-config-backups/$(date +%Y%m%d)/README.txt
echo "æ—¥æœŸ: $(date)" >> ~/k8s-config-backups/$(date +%Y%m%d)/README.txt
```

### ä½¿ç”¨ Git å¤‡ä»½
```bash
# åˆ›å»ºä¸€ä¸ªç§æœ‰ä»“åº“ä¿å­˜é…ç½®
mkdir -p ~/k8s-configs
cd ~/k8s-configs
git init

# å¤åˆ¶é…ç½®
cp /path/to/project/inventory/hosts.ini .
cp /path/to/project/inventory/group_vars/all.yml .

# æäº¤
git add .
git commit -m "Backup production config $(date +%Y%m%d)"

# æ¨é€åˆ°ç§æœ‰ä»“åº“ï¼ˆå¯é€‰ï¼‰
git remote add origin <your-private-repo>
git push -u origin main
```

---

## ğŸ” éªŒè¯é‡ç½®æ•ˆæœ

### æ£€æŸ¥æ–‡ä»¶æ˜¯å¦åˆ é™¤
```bash
# æ£€æŸ¥é…ç½®æ–‡ä»¶
ls inventory/hosts.ini
# åº”è¯¥è¾“å‡º: No such file or directory

ls inventory/group_vars/all.yml
# åº”è¯¥è¾“å‡º: No such file or directory
```

### æ£€æŸ¥ Git çŠ¶æ€
```bash
git status
# åº”è¯¥æ˜¾ç¤º clean æˆ–åªæœ‰æ‚¨ä¿®æ”¹çš„æ–‡ä»¶
```

### æ£€æŸ¥å¿½ç•¥çš„æ–‡ä»¶
```bash
git status --ignored
# åº”è¯¥çœ‹ä¸åˆ°è¢«å¿½ç•¥çš„é…ç½®æ–‡ä»¶ï¼ˆå› ä¸ºå®ƒä»¬å·²è¢«åˆ é™¤ï¼‰
```

---

## âš ï¸ æ³¨æ„äº‹é¡¹

### æ•°æ®ä¸¢å¤±è­¦å‘Š
- âš ï¸ `make reset` ä¼š**æ°¸ä¹…åˆ é™¤**æ‚¨çš„é…ç½®æ–‡ä»¶
- âš ï¸ åˆ é™¤çš„æ–‡ä»¶**æ— æ³•æ¢å¤**ï¼ˆé™¤éæœ‰å¤‡ä»½ï¼‰
- âš ï¸ è¯·ç¡®ä¿åœ¨æ‰§è¡Œå‰å¤‡ä»½é‡è¦é…ç½®

### ä¸ä¼šåˆ é™¤çš„å†…å®¹
- âœ… ç¤ºä¾‹é…ç½®æ–‡ä»¶ï¼ˆ*.exampleï¼‰
- âœ… æ‰€æœ‰æºä»£ç å’Œ Ansible Roles
- âœ… æ–‡æ¡£å’Œ README
- âœ… Git æäº¤å†å²
- âœ… å·²éƒ¨ç½²çš„é›†ç¾¤ï¼ˆä»åœ¨è¿œç¨‹èŠ‚ç‚¹ä¸Šè¿è¡Œï¼‰

### é›†ç¾¤ä¸å—å½±å“
- `make reset` åªæ¸…ç†**æœ¬åœ°é…ç½®æ–‡ä»¶**
- å·²éƒ¨ç½²çš„é›†ç¾¤**ç»§ç»­è¿è¡Œ**
- å¦‚éœ€å¸è½½é›†ç¾¤ï¼Œä½¿ç”¨ `make uninstall`

---

## ğŸ”§ é«˜çº§ç”¨æ³•

### å¼ºåˆ¶é‡ç½®ï¼ˆè·³è¿‡ç¡®è®¤ï¼‰
å¦‚æœéœ€è¦åœ¨è„šæœ¬ä¸­ä½¿ç”¨ï¼Œå¯ä»¥è¿™æ ·ï¼š

```bash
echo "yes" | make reset
```

### åªåˆ é™¤ç‰¹å®šæ–‡ä»¶
```bash
# åªåˆ é™¤ hosts.ini
rm -f inventory/hosts.ini

# åªåˆ é™¤ all.yml
rm -f inventory/group_vars/all.yml
```

### æ¸…ç†åç«‹å³é‡æ–°é…ç½®
```bash
# ä¸€é”®é‡ç½®å¹¶é‡æ–°åˆå§‹åŒ–
make reset && make setup
```

---

## ğŸ“Š å‘½ä»¤å¯¹æ¯”è¡¨

| ç‰¹æ€§ | `make clean` | `make reset` |
|------|-------------|-------------|
| åˆ é™¤ä¸´æ—¶æ–‡ä»¶ | âœ… æ˜¯ | âœ… æ˜¯ |
| åˆ é™¤æ—¥å¿—æ–‡ä»¶ | âœ… æ˜¯ | âœ… æ˜¯ |
| åˆ é™¤é…ç½®æ–‡ä»¶ | âŒ å¦ | âœ… æ˜¯ |
| éœ€è¦ç¡®è®¤ | âŒ å¦ | âœ… æ˜¯ |
| å¯é€†æ€§ | âœ… å®Œå…¨å¯é€† | âš ï¸ ä¸å¯é€† |
| é€‚åˆæ—¥å¸¸ä½¿ç”¨ | âœ… æ˜¯ | âŒ å¦ |
| æäº¤å‰ä½¿ç”¨ | âœ… å¯ä»¥ | âœ… æ¨è |

---

## ğŸ¯ å¿«é€Ÿå‚è€ƒ

### æ—¥å¸¸æ¸…ç†
```bash
make clean
```

### æäº¤å‰æ¸…ç†
```bash
make reset        # åˆ é™¤æ‰€æœ‰æœ¬åœ°é…ç½®
git status        # ç¡®è®¤çŠ¶æ€
git add .
git commit -m "..."
git push
```

### é‡æ–°å¼€å§‹
```bash
make reset        # é‡ç½®
make setup        # é‡æ–°åˆå§‹åŒ–
vim inventory/... # é…ç½®
make install      # éƒ¨ç½²
```

---

## ğŸ“š ç›¸å…³å‘½ä»¤

| å‘½ä»¤ | è¯´æ˜ |
|------|------|
| `make clean` | æ¸…ç†ä¸´æ—¶æ–‡ä»¶ |
| `make reset` | é‡ç½®åˆ°åˆå§‹çŠ¶æ€ |
| `make setup` | åˆå§‹åŒ–é…ç½® |
| `make uninstall` | å¸è½½é›†ç¾¤ |
| `git status` | æŸ¥çœ‹ Git çŠ¶æ€ |
| `git clean -fdx` | Git å®Œå…¨æ¸…ç†ï¼ˆè°¨æ…ä½¿ç”¨ï¼ï¼‰ |

---

## â“ å¸¸è§é—®é¢˜

### Q: make reset ä¼šåˆ é™¤é›†ç¾¤å—ï¼Ÿ
**A:** ä¸ä¼šã€‚`make reset` åªåˆ é™¤æœ¬åœ°é…ç½®æ–‡ä»¶ï¼Œå·²éƒ¨ç½²çš„é›†ç¾¤ç»§ç»­è¿è¡Œã€‚è¦å¸è½½é›†ç¾¤ï¼Œä½¿ç”¨ `make uninstall`ã€‚

### Q: åˆ é™¤çš„é…ç½®èƒ½æ¢å¤å—ï¼Ÿ
**A:** ä¸èƒ½ï¼Œé™¤éæ‚¨æœ‰å¤‡ä»½ã€‚å»ºè®®åœ¨é‡ç½®å‰å¤‡ä»½é‡è¦é…ç½®ã€‚

### Q: æˆ‘ä¸å°å¿ƒæ‰§è¡Œäº† make reset æ€ä¹ˆåŠï¼Ÿ
**A:** å¦‚æœæ‚¨æœ‰å¤‡ä»½ï¼Œæ¢å¤å¤‡ä»½æ–‡ä»¶ã€‚å¦‚æœæ²¡æœ‰ï¼Œéœ€è¦é‡æ–°é…ç½®ï¼š
```bash
make setup
vim inventory/hosts.ini
vim inventory/group_vars/all.yml
```

### Q: ç¤ºä¾‹æ–‡ä»¶ä¼šè¢«åˆ é™¤å—ï¼Ÿ
**A:** ä¸ä¼šã€‚`*.example` æ–‡ä»¶ä¿ç•™ï¼Œå¯ä»¥éšæ—¶å‚è€ƒã€‚

### Q: make clean å’Œ git clean æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ
**A:** 
- `make clean` åªåˆ é™¤ä¸´æ—¶æ–‡ä»¶ï¼Œä¿ç•™é…ç½®
- `git clean -fdx` åˆ é™¤æ‰€æœ‰æœªè·Ÿè¸ªçš„æ–‡ä»¶ï¼ˆåŒ…æ‹¬é…ç½®ï¼‰ï¼Œéå¸¸å±é™©

---

## ğŸ”— ç›¸å…³æ–‡æ¡£

- [README.md](README.md) - é¡¹ç›®ä¸»æ–‡æ¡£
- [QUICK-START-GUIDE.md](QUICK-START-GUIDE.md) - å¿«é€Ÿå¼€å§‹æŒ‡å—
- [GIT-CLEANUP-SUMMARY.md](GIT-CLEANUP-SUMMARY.md) - Git æ¸…ç†æ€»ç»“
- [.gitignore](.gitignore) - Git å¿½ç•¥è§„åˆ™

---

**æ–‡æ¡£ç‰ˆæœ¬**: v1.0  
**æœ€åæ›´æ–°**: 2025-10-20  
**ç»´æŠ¤è€…**: RKE2/K3S Ansible Automation Project

